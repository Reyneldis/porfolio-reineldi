---
import ProjectLayout from '../../layouts/ProjectLayout.astro';
import { getProjectBySlug } from '../../data/projects.ts';

export async function getStaticPaths() {
  const { PROJECTS } = await import('../../data/projects.ts');
  return PROJECTS.map(project => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;

if (!project) {
  return Astro.redirect('/404');
}

// Usamos la ruta directa a la imagen en public/
const imagePath = `/images/${project.image}`;
---

<ProjectLayout title={project.title}>
  <div class="container max-w-4xl px-6 py-16 mx-auto">
    <div class="relative mx-auto project-hero-image-wrapper">
      <img
        data-view-transition={`project-${project.slug}`}
        src={imagePath}
        alt={project.title}
        class="relative z-10 object-cover w-full h-64 rounded-lg shadow-2xl md:h-96 project-hero-image"
        width="800"
        height="450"
        loading="eager"
      />
    </div>

    <div class="mt-8 space-y-6">
      <h1
        class="text-4xl font-bold text-slate-900 dark:text-white font-display"
      >
        {project.title}
      </h1>
      <p class="text-lg text-slate-600 dark:text-slate-400">
        {project.description}
      </p>
      <div class="flex flex-wrap gap-2">
        {
          project.tech.map(tech => (
            <span class="px-3 py-1 text-sm font-semibold text-blue-700 rounded-full bg-blue-50 dark:bg-blue-900/30 dark:text-blue-300">
              {tech}
            </span>
          ))
        }
      </div>
      {
        project.highlights && (
          <div>
            <h2 class="mb-4 text-2xl font-bold text-slate-900 dark:text-white">
              Puntos Clave
            </h2>
            <ul class="space-y-2 list-disc list-inside text-slate-600 dark:text-slate-400">
              {project.highlights.map(highlight => (
                <li>{highlight}</li>
              ))}
            </ul>
          </div>
        )
      }
      <div>
        <a
          href={project.link}
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 px-6 py-3 text-lg font-semibold text-white transition-colors bg-blue-600 rounded-lg hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600"
        >
          Ver Proyecto en Vivo
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
            ></path>
          </svg>
        </a>
      </div>
    </div>
  </div>

  <!-- Estilos para la animaciÃ³n "Wow" -->
  <style>
    .project-hero-image-wrapper {
      perspective: 1000px;
    }

    .project-hero-image {
      animation: wow-entrance 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
      transform-origin: center;
      filter: blur(5px);
      opacity: 0;
    }

    .project-hero-image::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 50%;
      height: 100%;
      background: linear-gradient(
        to right,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.3) 50%,
        rgba(255, 255, 255, 0) 100%
      );
      transform: skewX(-25deg);
      animation: shimmer 2s 0.5s ease-out;
      z-index: 20;
    }

    @keyframes wow-entrance {
      0% {
        opacity: 0;
        filter: blur(10px) brightness(0.8);
        transform: scale(0.8) rotateX(10deg);
      }
      50% {
        opacity: 1;
        filter: blur(0) brightness(1);
      }
      100% {
        opacity: 1;
        filter: blur(0) brightness(1);
        transform: scale(1) rotateX(0deg);
      }
    }

    @keyframes shimmer {
      0% {
        left: -100%;
      }
      20% {
        left: 100%;
      }
      100% {
        left: 100%;
      }
    }
  </style>
</ProjectLayout>
